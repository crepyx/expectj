<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<title>User Documentation for ExpectJ 1.0</title>
<style>
<!--
p
	{margin-right:0in;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	}
 p.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman";
	margin-left:0in; margin-right:0in; margin-top:0in}
h1
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	font-size:16.0pt;
	font-family:Arial;
	font-weight:bold}
p.MsoBodyTextIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:Verdana;
	}
 li.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman";
	margin-left:0in; margin-right:0in; margin-top:0in}
-->
</style>
</head>

<body>

<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1" height="177" bordercolorlight="#FFFFFF" bordercolordark="#FFFFFF" bgcolor="#FFFFFF">
  <tr>
    <td width="100%" height="43" bgcolor="#FFFFFF" colspan="2"><p align="center">
<span style="font-family: Verdana"><b>
    <font size="2">ExpectJ 
    1.0 User Documentation<br>
    </font></b><i><font size="2">Every documented bug becomes a 
feature</font></i></span><p align="center">
<font face="Verdana">
<A href="http://sourceforge.net"> <IMG
src="http://sourceforge.net/sflogo.php?group_id=74328&type=5"
width="210" height="62" border="0"
alt="SourceForge.net Logo" /></A></font><span style="font-family: Verdana"><i><font size="2"><br>
&nbsp;</font></i></span><hr></td>
  </tr>
  <tr>
    <td width="1%" height="133" bgcolor="#FFFFFF">&nbsp;</td>
    <td width="99%" height="133">
<ul>
  <li><font face="Verdana" size="2"><a href="#Introduction">Introduction</a></font></li>
  <li><font face="Verdana" size="2"><a href="#API Specification">API 
  Specification</a></font></li>
  <li><font face="Verdana" size="2"><a href="#Example">Example</a></font></li>
  <li><font face="Verdana" size="2"><a href="#Known Issues">Known Issues</a><br>
&nbsp;</font></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<ul>
  <li><font face="Verdana" size="2"><u><b><a name="Introduction">Introduction</a></b><br>
  </u>ExpectJ is a Java implementation of the Unix <i>expect </i>utility. 
  ExpectJ provides a Unix expect like support to write Java Programs that 
  communicate with other programs and perform some operation on them. <br>
  If you are not familiar with working of the Unix <i>expect</i> utility, please 
  refer to man page of <i>expect</i>. Usage of ExpectJ requires a proper 
  understanding of the Unix expect utility.<br>
  For example using ExpectJ you can write a Java program that telnets to a host 
  machine and deletes the contents of <i>/tmp</i>. This program when configured 
  as a <i>cron</i> job will always keep the <i>/tmp</i> under the specified 
  limit.<br>
&nbsp;</font></li>
  <li><font face="Verdana" size="2"><u><b><a name="API Specification">API 
  Specification</a></b></u><br>
  <br>
  <b>Package Structure:</b><br>
  All ExpectJ classes are located in expectj package.<br>
  <br>
  <b>Classes:</b><br>
  Following classes will be used:<br>
  <br>
  <b><i><a name="expectj.ExpectJ">expectj.ExpectJ</a><br>
  </i></b>ExpectJ is the entry point to API. ExpectJ acts as a single point 
  factory container for spawning processes and performing other ExpectJ related 
  functions.<br>
  <br>
  Constructor:<br>
  <br>
  <i><a name="ExpectJ(String sLogFile, long  lDefaultTimeOut)">&nbsp;&nbsp;&nbsp; 
  ExpectJ(String sLogFile, long&nbsp; lDefaultTimeOut)</a><br>
  </i>This constructor creates an ExpectJ object. This object can further be 
  used to spawn different processes and communicate with them. <i>sLogFile </i>
  is location of the log file where ExpectJ write debug messages. <i>
  lDefaultTimeOut </i>is default timeout value for expect commands. A default 
  value of -1 means indefinite timeout.<br>
  <br>
  Methods:<br>
&nbsp;&nbsp;&nbsp; <br>
  <i>&nbsp;&nbsp;&nbsp; <a name="spawn(String sCommand)">spawn(String sCommand)
  </a><br>
  </i>This method spawns a process <i>sCommand </i>in a different thread from 
  the invoker thread and returns an object <a href="#expectj.SpawnedProcess">
  SpawnedProcess</a> which can be use to further communicate with the process 
  spawned by the spawn command. A single ExpectJ object can be used to spawn an 
  many processes and possible, but a SpawnedProcess object represents only one 
  process.&nbsp; <br>
  <br>
  <br>
  <b><i><a name="expectj.SpawnedProcess">expectj.SpawnedProcess</a><br>
  </i></b>This class represents a SpawnedProcess and all communication with the 
  process can be done using this object. <a href="#spawn(String sCommand)">
  ExpectJ.spawn</a> returns an instance of SpawnedProcess.<br>
  <br>
  Methods:<br>
  <br>
  <i><a name="expect( String pattern, long lTimeOut)  throws ExpectJException">&nbsp;&nbsp;&nbsp; 
  expect( String pattern, long lTimeOut)&nbsp; throws ExpectJException</a><br>
  </i>This method functions exactly like the Unix <i>expect</i> command. It 
  waits untill a string is read from the standard output stream of the spawned 
  process that matches the string <i>pattern. </i>SpawnedProcess does a cases 
  insensitive substring match for <i>pattern </i>against the output of the 
  spawned process. lTimeOut is the timeout in seconds that the expect command 
  should wait for the pattern to match. This function returns when a match is 
  found or after <i>lTimOut </i>seconds. You can use the 
  SpawnedProcess.isLastExpectTimeOut() to identify the return path of the 
  method. A timeout of -1 will make the expect method wait indefinitely untill 
  the supplied pattern matches with the Standard Out. This method throws an 
  ExpectJException when some error occurrs.<br>
  <br>
  <i>&nbsp;&nbsp;&nbsp; <a name="expect( String pattern)">expect( String 
  pattern)</a>&nbsp; throws JExpectException</i>&nbsp; <br>
  This method functions exactly like
  <a href="#expect( String pattern, long lTimeOut)  throws ExpectJException">
  expect</a> described above, but uses the default timeout specified in the
  <a href="#ExpectJ(String sLogFile, long  lDefaultTimeOut)">ExpectJ constructor</a>.
  <br>
  <br>
  <i>&nbsp;&nbsp;&nbsp; expectErr( String pattern, long lTimeOut)&nbsp; throws 
  JExpectException<br>
  </i>This method functions exactly like the corresponding
  <a href="#expect( String pattern, long lTimeOut)  throws ExpectJException">
  expect</a> function except for it tries to match the pattern with the output&nbsp; 
  of standard error stream of the spawned process.<br>
  <br>
  <i>&nbsp;&nbsp;&nbsp; expectErr(String pattern) throws JExpectException <br>
  </i>This method functions exactly like the corresponding
  <a href="#expect( String pattern)">expect</a> function except for it tries to 
  match the pattern with the output&nbsp; of standard error stream of the 
  spawned process.<br>
  <br>
&nbsp;&nbsp;&nbsp;&nbsp; isLastExpectTimeOut()<br>
&nbsp;This method returns true if the last expect() or expectErr() method 
  returned because of a time out rather then a match against the output of the 
  process. This method is common to both expect and expectErr.<br>
  <br>
  <i>&nbsp;&nbsp; <a name="send(String line)">&nbsp;send(String line)</a> throws 
  JExpectException<br>
  </i>This method writes the string <i>line </i>to the standard input of the 
  spawned process. It throws a JExpectException if the spawned process has 
  already exited.<br>
  <br>
  <i>&nbsp;&nbsp;&nbsp; isClosed()<br>
  </i>This method returns true if the process has already exited. This method 
  shoud be use use to check the process status before invoking
  <a href="#send(String line)">send</a>()<br>
  <br>
  <i>&nbsp;&nbsp; getExitValue()<br>
  </i>This method returns the exit code of the process if the process has 
  already exited.<br>
  <br>
  <i>&nbsp;&nbsp; stop()<br>
  </i>This method kills the process represented by SpawnedProcess object.<br>
  <br>
  <i>&nbsp;&nbsp; interact()<br>
  </i>This method functions like exactly the Unix interact command. It allows 
  the user to interact with the spawned process.<br>
  Known Issues: User input is echoed twice on the screen, need to fix this ;)<br>
  <br>
&nbsp;&nbsp; getCurrentStandardOutContents() </font>
  <font face="Verdana" size="1"><i>(*new in 1.1*)</i></font><font face="Verdana" size="2"><br>
  This method returns the contents of Standard Out of the process represented by 
  SpawnedProcess object.<br>
&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp; getCurrentStandardErrContents()&nbsp; </font>
  <font face="Verdana" size="1"><i>(*new in 1.1*)</i></font><font face="Verdana" size="2">&nbsp;
  <br>
  This method returns the contents of Standard Err of the process represented by 
  SpawnedProcess object.<br>
&nbsp;</font></li>
</ul>
<ul>
  <li><b><u><font face="Verdana" size="2"><a name="Example">Example</a></font></u></b><br>
  <font face="Verdana" size="2">Consider a simple example of a writing an 
  application that telnets to a host machine and deletes a particular file '/tmp/my.log' 
  on the host machine. The code snippet would look something like this.<br>
  <br>
  JExpect exp = new JExpect(&quot;/tmp/expectJ.log&quot;, 20);<br>
  String command = &quot;telnet myhost&quot;;<br>
  SpawnedProcess sp = exp.spawn(command);<br>
  sp.expect(&quot;login&quot;);<br>
  sp.send(&quot;myhost\n&quot;);<br>
  System.out.println(&quot;Expect Status &quot; + sp.isLastExpectTimeOut());<br>
  if (sp.isLastExpectTimeOut()) {<br>
&nbsp;&nbsp; System.err.println(&quot;Did not match&quot;);<br>
&nbsp;&nbsp; System.exit(1);<br>
  }<br>
  sp.expect(&quot;Password&quot;);<br>
  sp.send(&quot;mypass\n&quot;);<br>
  sp.send(&quot;rm /tmp/my.log\n&quot;);<br>
  System.out.println(&quot;Process Contents:&quot; + sp.getCurrentStandardOutContents());<br>
  sp.interact();<br>
  System.out.println(&quot;Started Interacting&quot;);<br>
  // Play with telnet session here, you can use send(&quot;exit\n&quot;) if you dont want 
  to interact.<br>
  Thread.sleep(10000000000);<br>
  System.out.println(&quot;Thread Woken Up, killing the telnet session&quot;);<br>
  sp.stop();<br>
  &nbsp;</font></li>
  <li><font face="Verdana" size="2"><u><b><a name="Known Issues">Known Issues</a></b></u><br>
  1. If spawning of process does not work on windows use &quot;cmd /c&quot; to spawn the 
  process. For example to spawn the label command using ExpectJ use &quot;cmd /c 
  label&quot;<br>
  2. Make sure you use the line feed characters wherever necessary in send 
  methods.<br>
  3. Telnet does not seem to work on my windows box, if you can make it work 
  please let me know.<br>
  4. In interact mode, the input from the user is echoed twice on the screen to 
  fix this I need to swich off the echo on Standard Input, if anybody knows how 
  to do it in java please let me know.</font></li>
</ul>
<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;</td>
  </tr>
  <tr>
    <td width="1%" height="133" bgcolor="#FFFFFF">&nbsp;</td>
    <td width="99%" height="133">
&nbsp;</td>
  </tr>
</table>

</body>

</html>